from .digital_net_any_base import DigitalNetAnyBases


class Faure(DigitalNetAnyBases):
    r"""
    Low discrepancy Faure points.

    Note:
        - The first point of an unrandomized Faure sequence is the origin.
    
    Examples:
        >>> discrete_distrib = Faure(4,seed=7)
        >>> discrete_distrib(4)
        array([[0.33534484, 0.26765076, 0.49135906, 0.6052543 ],
               [0.45194823, 0.53502655, 0.93195248, 0.5024511 ],
               [0.69367212, 0.09800441, 0.77275989, 0.35304609],
               [0.0086832 , 0.96517227, 0.01157255, 0.85055011]])
        >>> discrete_distrib
        Faure (AbstractLDDiscreteDistribution)
            d               2^(2)
            replications    1
            randomize       LMS DP
            t               28
            n_limit         2^(32)
            entropy         7
        
        Replications of independent randomizations 

        >>> x = Faure(3,seed=7,replications=2)(4)
        >>> x.shape
        (2, 4, 3)
        >>> x
        array([[[0.46995809, 0.81347921, 0.84921511],
                [0.22573669, 0.29702269, 0.03044283],
                [0.68125682, 0.38949622, 0.65611464],
                [0.58494536, 0.14367836, 0.43908813]],
        <BLANKLINE>
               [[0.44633162, 0.60684282, 0.96393795],
                [0.13904548, 0.73709456, 0.37711571],
                [0.79070871, 0.15560342, 0.12328662],
                [0.40389155, 0.97863405, 0.0114599 ]]])

        Unrandomized Faure 

        >>> Faure(4,randomize="FALSE",seed=7)(10,warn=False)
        array([[0.  , 0.  , 0.  , 0.  ],
               [0.2 , 0.2 , 0.2 , 0.2 ],
               [0.4 , 0.4 , 0.4 , 0.4 ],
               [0.6 , 0.6 , 0.6 , 0.6 ],
               [0.8 , 0.8 , 0.8 , 0.8 ],
               [0.04, 0.24, 0.44, 0.64],
               [0.24, 0.44, 0.64, 0.84],
               [0.44, 0.64, 0.84, 0.04],
               [0.64, 0.84, 0.04, 0.24],
               [0.84, 0.04, 0.24, 0.44]])
        
        All randomizations 

        >>> Faure(3,randomize="LMS DP",seed=7)(4)
        array([[0.60869072, 0.76096155, 0.79807281],
               [0.03946861, 0.56443723, 0.39462162],
               [0.84046405, 0.17459934, 0.31263449],
               [0.39080182, 0.42253604, 0.09713822]])
        >>> Faure(3,randomize="LMS DS",seed=7)(4)
        array([[0.09363194, 0.63822128, 0.52606134],
               [0.66021198, 0.02837507, 0.7155204 ],
               [0.85642224, 0.83340554, 0.22549083],
               [0.31989976, 0.30119144, 0.00893035]])
        >>> Faure(3,randomize="LMS",seed=7)(4,warn=False)
        array([[0.        , 0.        , 0.        ],
               [0.5706961 , 0.84756013, 0.63390413],
               [0.80394278, 0.65243798, 0.82336297],
               [0.22678173, 0.67547662, 0.93144564]])
        >>> Faure(3,randomize="DP",seed=7)(4)
        array([[0.62331102, 0.65595286, 0.5208953 ],
               [0.28997769, 0.98928619, 0.18756197],
               [0.95664436, 0.32261952, 0.85422863],
               [0.51219991, 0.87817508, 0.96533975]])
        >>> Faure(3,randomize="DS",seed=7)(4)
        array([[0.68058188, 0.90130449, 0.36582045],
               [0.01391521, 0.23463782, 0.69915378],
               [0.34724854, 0.56797116, 0.03248711],
               [0.79169299, 0.0124156 , 0.14359822]])
        >>> Faure(3,randomize="NUS",seed=7)(4)
        array([[0.077534  , 0.99285569, 0.64186774],
               [0.82225806, 0.4963679 , 0.86453228],
               [0.48498632, 0.0833722 , 0.06011164],
               [0.15691802, 0.60236449, 0.11226224]])
        
        Replications of randomizations 

        >>> Faure(3,randomize="LMS DP",seed=7,replications=2)(4)
        array([[[0.46995809, 0.81347921, 0.84921511],
                [0.22573669, 0.29702269, 0.03044283],
                [0.68125682, 0.38949622, 0.65611464],
                [0.58494536, 0.14367836, 0.43908813]],
        <BLANKLINE>
               [[0.44633162, 0.60684282, 0.96393795],
                [0.13904548, 0.73709456, 0.37711571],
                [0.79070871, 0.15560342, 0.12328662],
                [0.40389155, 0.97863405, 0.0114599 ]]])
        >>> Faure(3,randomize="LMS DS",seed=7,replications=2)(4)
        array([[[0.19013265, 0.7862616 , 0.14326169],
                [0.42749458, 0.62124939, 0.44383185],
                [0.99392239, 0.09248901, 0.95426197],
                [0.08291465, 0.44918094, 0.73718529]],
        <BLANKLINE>
               [[0.99845473, 0.25364834, 0.71343436],
                [0.30560913, 0.44571837, 0.63669129],
                [0.65411465, 0.69134908, 0.11147115],
                [0.71169196, 0.62549563, 0.22313681]]])
        >>> Faure(3,randomize="LMS",seed=7,replications=2)(4,warn=False)
        array([[[0.        , 0.        , 0.        ],
                [0.5706961 , 0.84756013, 0.63390413],
                [0.80394278, 0.65243798, 0.82336297],
                [0.22678173, 0.67547662, 0.93144564]],
        <BLANKLINE>
               [[0.        , 0.        , 0.        ],
                [0.34851179, 0.57896969, 0.93575568],
                [0.69285188, 0.80808804, 0.52582983],
                [0.20726949, 0.37184791, 0.6375009 ]]])
        >>> Faure(3,randomize="DS",seed=7,replications=2)(4)
        array([[[0.68058188, 0.90130449, 0.36582045],
                [0.01391521, 0.23463782, 0.69915378],
                [0.34724854, 0.56797116, 0.03248711],
                [0.79169299, 0.0124156 , 0.14359822]],
        <BLANKLINE>
               [[0.95466555, 0.56062266, 0.29687589],
                [0.28799888, 0.89395599, 0.63020922],
                [0.62133222, 0.22728933, 0.96354256],
                [0.73244333, 0.67173377, 0.74132033]]])
        >>> Faure(3,randomize="DP",seed=7,replications=2)(4)
        array([[[0.62331102, 0.65595286, 0.5208953 ],
                [0.28997769, 0.98928619, 0.18756197],
                [0.95664436, 0.32261952, 0.85422863],
                [0.51219991, 0.87817508, 0.96533975]],
        <BLANKLINE>
               [[0.65992302, 0.22190291, 0.57359374],
                [0.32658969, 0.88856957, 0.90692707],
                [0.99325635, 0.55523624, 0.2402604 ],
                [0.54881191, 0.77745846, 0.12914929]]])
        >>> Faure(3,randomize="NUS",seed=7,replications=2)(4)
        array([[[0.077534  , 0.99285569, 0.64186774],
                [0.82225806, 0.4963679 , 0.86453228],
                [0.48498632, 0.0833722 , 0.06011164],
                [0.15691802, 0.60236449, 0.11226224]],
        <BLANKLINE>
               [[0.03739061, 0.16158904, 0.85379075],
                [0.7635801 , 0.40075819, 0.56644152],
                [0.49937232, 0.74097216, 0.02663559],
                [0.24837929, 0.59622709, 0.12164937]]])

    """
    
    DEFAULT_GENERATING_MATRICES = "FAURE"
