from .digital_net_any_base import DigitalNetAnyBases


class Faure(DigitalNetAnyBases):
    r"""
    Low discrepancy Faure points.

    Note:
        - The first point of an unrandomized Faure sequence is the origin.
    
    Examples:
        >>> discrete_distrib = Faure(4,seed=7)
        >>> discrete_distrib(25)
        array([[0.33534484, 0.26765076, 0.49135906, 0.6052543 ],
               [0.45194823, 0.53502655, 0.93195248, 0.5024511 ],
               [0.69367212, 0.09800441, 0.77275989, 0.35304609],
               [0.0086832 , 0.96517227, 0.01157255, 0.85055011],
               [0.97041531, 0.63254601, 0.25235643, 0.18869841],
               [0.20862319, 0.45844039, 0.64733082, 0.97109116],
               [0.57003274, 0.12560935, 0.08772865, 0.02771165],
               [0.73495613, 0.91292101, 0.32692686, 0.68483526],
               [0.05156003, 0.78796242, 0.56754229, 0.54342666],
               [0.89329109, 0.21506683, 0.80647015, 0.27293526],
               [0.25277941, 0.07296122, 0.23030907, 0.46332812],
               [0.4941915 , 0.94839898, 0.46928813, 0.39348452],
               [0.60952104, 0.69550381, 0.90983954, 0.81009581],
               [0.17092444, 0.37887902, 0.74911456, 0.10721583],
               [0.93584834, 0.40585698, 0.18944839, 0.72587572],
               [0.36989645, 0.85447136, 0.97641039, 0.14826857],
               [0.53450751, 0.7376398 , 0.61725827, 0.64572148],
               [0.65143961, 0.28501343, 0.05601974, 0.58393268],
               [0.09284913, 0.59218182, 0.29689116, 0.23247628],
               [0.80817253, 0.02749358, 0.53742056, 0.88960099],
               [0.29406032, 0.64634796, 0.15459067, 0.31205785],
               [0.40906423, 0.35338995, 0.39383649, 0.93066193],
               [0.77079531, 0.50849426, 0.43438996, 0.06810554],
               [0.13540741, 0.17593145, 0.87500744, 0.76631324],
               [0.85233694, 0.81903638, 0.71417647, 0.42286144]])
        >>> discrete_distrib
        Faure (AbstractLDDiscreteDistribution)
            d               2^(2)
            replications    1
            randomize       LMS DP
            t               28
            n_limit         2^(32)
            entropy         7
        
        Replications of independent randomizations 

        >>> x = Faure(3,seed=7,replications=2)(9)
        >>> x.shape
        (2, 9, 3)
        >>> x
        array([[[0.46995809, 0.81347921, 0.84921511],
                [0.22573669, 0.29702269, 0.03044283],
                [0.68125682, 0.38949622, 0.65611464],
                [0.58494536, 0.14367836, 0.43908813],
                [0.00739063, 0.63809438, 0.95363225],
                [0.79609189, 0.71822727, 0.1472069 ],
                [0.36690976, 0.47240941, 0.2470566 ],
                [0.12284101, 0.96819212, 0.55174327],
                [0.91154206, 0.05940035, 0.73295342]],
        <BLANKLINE>
               [[0.44633162, 0.60684282, 0.96393795],
                [0.13904548, 0.73709456, 0.37711571],
                [0.79070871, 0.15560342, 0.12328662],
                [0.40389155, 0.97863405, 0.0114599 ],
                [0.05951757, 0.10889081, 0.85272281],
                [0.71514612, 0.52312704, 0.59877454],
                [0.64931396, 0.23505158, 0.48710589],
                [0.30097968, 0.36957094, 0.23358374],
                [0.99369356, 0.78380717, 0.74090153]]])

        Unrandomized Faure 

        >>> Faure(4,randomize="FALSE",seed=7)(25,warn=False)
        array([[0.  , 0.  , 0.  , 0.  ],
               [0.2 , 0.2 , 0.2 , 0.2 ],
               [0.4 , 0.4 , 0.4 , 0.4 ],
               [0.6 , 0.6 , 0.6 , 0.6 ],
               [0.8 , 0.8 , 0.8 , 0.8 ],
               [0.04, 0.24, 0.44, 0.64],
               [0.24, 0.44, 0.64, 0.84],
               [0.44, 0.64, 0.84, 0.04],
               [0.64, 0.84, 0.04, 0.24],
               [0.84, 0.04, 0.24, 0.44],
               [0.08, 0.48, 0.88, 0.28],
               [0.28, 0.68, 0.08, 0.48],
               [0.48, 0.88, 0.28, 0.68],
               [0.68, 0.08, 0.48, 0.88],
               [0.88, 0.28, 0.68, 0.08],
               [0.12, 0.72, 0.32, 0.92],
               [0.32, 0.92, 0.52, 0.12],
               [0.52, 0.12, 0.72, 0.32],
               [0.72, 0.32, 0.92, 0.52],
               [0.92, 0.52, 0.12, 0.72],
               [0.16, 0.96, 0.76, 0.56],
               [0.36, 0.16, 0.96, 0.76],
               [0.56, 0.36, 0.16, 0.96],
               [0.76, 0.56, 0.36, 0.16],
               [0.96, 0.76, 0.56, 0.36]])
        
        All randomizations 

        >>> Faure(3,randomize="LMS DP",seed=7)(9)
        array([[0.60869072, 0.76096155, 0.79807281],
               [0.03946861, 0.56443723, 0.39462162],
               [0.84046405, 0.17459934, 0.31263449],
               [0.39080182, 0.42253604, 0.09713822],
               [0.15491328, 0.22747922, 0.90356545],
               [0.95606114, 0.84998662, 0.50057213],
               [0.50599254, 0.09792123, 0.60600892],
               [0.26995157, 0.88915344, 0.20257439],
               [0.73776586, 0.51292533, 0.68846996]])
        >>> Faure(3,randomize="LMS DS",seed=7)(9)
        array([[0.09363194, 0.63822128, 0.52606134],
               [0.66021198, 0.02837507, 0.7155204 ],
               [0.85642224, 0.83340554, 0.22549083],
               [0.31989976, 0.30119144, 0.00893035],
               [0.55299403, 0.70247804, 0.63048602],
               [0.7492045 , 0.49633053, 0.81948782],
               [0.20034171, 0.96431985, 0.92797189],
               [0.43358859, 0.3653974 , 0.11741381],
               [0.9629798 , 0.17028087, 0.41752644]])
        >>> Faure(3,randomize="LMS",seed=7)(9,warn=False)
        array([[0.        , 0.        , 0.        ],
               [0.5706961 , 0.84756013, 0.63390413],
               [0.80394278, 0.65243798, 0.82336297],
               [0.22678173, 0.67547662, 0.93144564],
               [0.46399184, 0.50916041, 0.12088811],
               [0.69723852, 0.31536484, 0.40911072],
               [0.11956371, 0.33845241, 0.52953528],
               [0.35692624, 0.18443172, 0.70664719],
               [0.92335406, 0.97711587, 0.22942236]])
        >>> Faure(3,randomize="DP",seed=7)(9)
        array([[0.62331102, 0.65595286, 0.5208953 ],
               [0.28997769, 0.98928619, 0.18756197],
               [0.95664436, 0.32261952, 0.85422863],
               [0.51219991, 0.87817508, 0.96533975],
               [0.17886658, 0.21150841, 0.63200641],
               [0.84553325, 0.54484175, 0.29867308],
               [0.4010888 , 0.1003973 , 0.07645086],
               [0.06775547, 0.43373064, 0.74311752],
               [0.73442213, 0.76706397, 0.40978419]])
        >>> Faure(3,randomize="DS",seed=7)(9)
        array([[0.68058188, 0.90130449, 0.36582045],
               [0.01391521, 0.23463782, 0.69915378],
               [0.34724854, 0.56797116, 0.03248711],
               [0.79169299, 0.0124156 , 0.14359822],
               [0.12502632, 0.34574893, 0.47693156],
               [0.45835966, 0.67908227, 0.81026489],
               [0.9028041 , 0.45686005, 0.921376  ],
               [0.23613743, 0.79019338, 0.25470933],
               [0.56947077, 0.12352671, 0.58804267]])
        >>> Faure(3,randomize="NUS",seed=7)(9)
        array([[0.077534  , 0.99285569, 0.64186774],
               [0.82225806, 0.4963679 , 0.86453228],
               [0.48498632, 0.0833722 , 0.06011164],
               [0.15691802, 0.60236449, 0.11226224],
               [0.95445636, 0.2796012 , 0.54752025],
               [0.61890325, 0.84183901, 0.70654863],
               [0.25089638, 0.17805972, 0.95988146],
               [0.68344029, 0.77065782, 0.26676153],
               [0.4322891 , 0.40799837, 0.34911626]])
        
        Replications of randomizations 

        >>> Faure(3,randomize="LMS DP",seed=7,replications=2)(9)
        array([[[0.46995809, 0.81347921, 0.84921511],
                [0.22573669, 0.29702269, 0.03044283],
                [0.68125682, 0.38949622, 0.65611464],
                [0.58494536, 0.14367836, 0.43908813],
                [0.00739063, 0.63809438, 0.95363225],
                [0.79609189, 0.71822727, 0.1472069 ],
                [0.36690976, 0.47240941, 0.2470566 ],
                [0.12284101, 0.96819212, 0.55174327],
                [0.91154206, 0.05940035, 0.73295342]],
        <BLANKLINE>
               [[0.44633162, 0.60684282, 0.96393795],
                [0.13904548, 0.73709456, 0.37711571],
                [0.79070871, 0.15560342, 0.12328662],
                [0.40389155, 0.97863405, 0.0114599 ],
                [0.05951757, 0.10889081, 0.85272281],
                [0.71514612, 0.52312704, 0.59877454],
                [0.64931396, 0.23505158, 0.48710589],
                [0.30097968, 0.36957094, 0.23358374],
                [0.99369356, 0.78380717, 0.74090153]]])
        >>> Faure(3,randomize="LMS DS",seed=7,replications=2)(9)
        array([[[1.90132648e-01, 7.86261604e-01, 1.43261685e-01],
                [4.27494577e-01, 6.21249393e-01, 4.43831847e-01],
                [9.93922386e-01, 9.24890107e-02, 9.54261973e-01],
                [8.29146531e-02, 4.49180940e-01, 7.37185290e-01],
                [6.53610094e-01, 2.95352182e-01, 2.47631786e-01],
                [8.86856776e-01, 7.55465004e-01, 5.48200701e-01],
                [2.96893357e-01, 1.12311024e-01, 6.56285230e-01],
                [5.34102847e-01, 9.58324412e-01, 8.45725185e-01],
                [7.67349545e-01, 4.29366454e-01, 3.51846617e-02]],
        <BLANKLINE>
               [[9.98454735e-01, 2.53648344e-01, 7.13434357e-01],
                [3.05609133e-01, 4.45718366e-01, 6.36691290e-01],
                [6.54114646e-01, 6.91349078e-01, 1.11471149e-01],
                [7.11691963e-01, 6.25495629e-01, 2.23136805e-01],
                [5.60878749e-02, 8.17408217e-01, 8.25559119e-01],
                [4.00275568e-01, 5.89230529e-02, 4.15633066e-01],
                [7.91236327e-01, 9.93070231e-01, 5.25932625e-01],
                [1.39697286e-01, 1.89249857e-01, 7.14552095e-04],
                [4.46998476e-01, 4.30617921e-01, 9.36315716e-01]]])
        >>> Faure(3,randomize="LMS",seed=7,replications=2)(9,warn=False)
        array([[[0.        , 0.        , 0.        ],
                [0.5706961 , 0.84756013, 0.63390413],
                [0.80394278, 0.65243798, 0.82336297],
                [0.22678173, 0.67547662, 0.93144564],
                [0.46399184, 0.50916041, 0.12088811],
                [0.69723852, 0.31536484, 0.40911072],
                [0.11956371, 0.33845241, 0.52953528],
                [0.35692624, 0.18443172, 0.70664719],
                [0.92335406, 0.97711587, 0.22942236]],
        <BLANKLINE>
               [[0.        , 0.        , 0.        ],
                [0.34851179, 0.57896969, 0.93575568],
                [0.69285188, 0.80808804, 0.52582983],
                [0.20726949, 0.37184791, 0.6375009 ],
                [0.55146283, 0.94654367, 0.11228285],
                [0.8628786 , 0.17977726, 0.71455089],
                [0.2908789 , 0.74353714, 0.82500264],
                [0.59818511, 0.31838531, 0.41492625],
                [0.94242359, 0.54735751, 0.22303965]]])
        >>> Faure(3,randomize="DS",seed=7,replications=2)(9)
        array([[[0.68058188, 0.90130449, 0.36582045],
                [0.01391521, 0.23463782, 0.69915378],
                [0.34724854, 0.56797116, 0.03248711],
                [0.79169299, 0.0124156 , 0.14359822],
                [0.12502632, 0.34574893, 0.47693156],
                [0.45835966, 0.67908227, 0.81026489],
                [0.9028041 , 0.45686005, 0.921376  ],
                [0.23613743, 0.79019338, 0.25470933],
                [0.56947077, 0.12352671, 0.58804267]],
        <BLANKLINE>
               [[0.95466555, 0.56062266, 0.29687589],
                [0.28799888, 0.89395599, 0.63020922],
                [0.62133222, 0.22728933, 0.96354256],
                [0.73244333, 0.67173377, 0.74132033],
                [0.06577666, 0.0050671 , 0.07465367],
                [0.39911   , 0.33840044, 0.407987  ],
                [0.84355444, 0.11617822, 0.51909811],
                [0.17688777, 0.44951155, 0.85243145],
                [0.51022111, 0.78284488, 0.18576478]]])
        >>> Faure(3,randomize="DP",seed=7,replications=2)(9)
        array([[[0.62331102, 0.65595286, 0.5208953 ],
                [0.28997769, 0.98928619, 0.18756197],
                [0.95664436, 0.32261952, 0.85422863],
                [0.51219991, 0.87817508, 0.96533975],
                [0.17886658, 0.21150841, 0.63200641],
                [0.84553325, 0.54484175, 0.29867308],
                [0.4010888 , 0.1003973 , 0.07645086],
                [0.06775547, 0.43373064, 0.74311752],
                [0.73442213, 0.76706397, 0.40978419]],
        <BLANKLINE>
               [[0.65992302, 0.22190291, 0.57359374],
                [0.32658969, 0.88856957, 0.90692707],
                [0.99325635, 0.55523624, 0.2402604 ],
                [0.54881191, 0.77745846, 0.12914929],
                [0.21547857, 0.44412513, 0.46248263],
                [0.88214524, 0.1107918 , 0.79581596],
                [0.4377008 , 0.66634735, 0.68470485],
                [0.10436746, 0.33301402, 0.01803818],
                [0.77103413, 0.99968068, 0.35137152]]])
        >>> Faure(3,randomize="NUS",seed=7,replications=2)(9)
        array([[[0.077534  , 0.99285569, 0.64186774],
                [0.82225806, 0.4963679 , 0.86453228],
                [0.48498632, 0.0833722 , 0.06011164],
                [0.15691802, 0.60236449, 0.11226224],
                [0.95445636, 0.2796012 , 0.54752025],
                [0.61890325, 0.84183901, 0.70654863],
                [0.25089638, 0.17805972, 0.95988146],
                [0.68344029, 0.77065782, 0.26676153],
                [0.4322891 , 0.40799837, 0.34911626]],
        <BLANKLINE>
               [[0.03739061, 0.16158904, 0.85379075],
                [0.7635801 , 0.40075819, 0.56644152],
                [0.49937232, 0.74097216, 0.02663559],
                [0.24837929, 0.59622709, 0.12164937],
                [0.79067346, 0.83319946, 0.67040549],
                [0.40808716, 0.31605175, 0.51589378],
                [0.15774296, 0.96060354, 0.35917763],
                [0.96867006, 0.05032588, 0.24759375],
                [0.59326363, 0.50120469, 0.9906825 ]]])

        Higher order Faure
        
        >>> Faure(3,randomize="LMS DP",seed=7,alpha=2)(9)
        array([[0.07060326, 0.24965078, 0.49971375],
               [0.9104272 , 0.77359118, 0.02813304],
               [0.52709818, 0.51562414, 0.97220901],
               [0.23236901, 0.55967785, 0.28909699],
               [0.88746566, 0.08382775, 0.77956468],
               [0.39256201, 0.81762837, 0.43144077],
               [0.20940728, 0.91289379, 0.71118926],
               [0.71589223, 0.4203758 , 0.56884549],
               [0.59136462, 0.16673034, 0.219807  ]])
        >>> Faure(3,randomize="LMS DS",seed=7,alpha=2)(9)
        array([[0.27004662, 0.64652898, 0.04873353],
               [0.35569696, 0.06066804, 0.54773651],
               [0.88670561, 0.79188841, 0.90363807],
               [0.03415605, 0.99796556, 0.62789873],
               [0.5267559 , 0.39579989, 0.76064852],
               [0.94711696, 0.14327166, 0.11150335],
               [0.20948284, 0.29996665, 0.83571342],
               [0.62847216, 0.71019873, 0.30272608],
               [0.67845718, 0.45371208, 0.36140179]])
        >>> Faure(3,randomize="LMS",seed=7,alpha=2)(9,warn=False)
        array([[0.        , 0.        , 0.        ],
               [0.53148918, 0.85880934, 0.51685452],
               [0.95184459, 0.60232457, 0.98293576],
               [0.21282738, 0.35205188, 0.58389855],
               [0.59616274, 0.20653524, 0.72441959],
               [0.68272695, 0.94187019, 0.19189138],
               [0.2733855 , 0.7034865 , 0.79264466],
               [0.35996672, 0.5457835 , 0.27107157],
               [0.85440183, 0.28913878, 0.43628397]])
        >>> Faure(3,randomize="NUS",seed=7,alpha=2)(9)
        array([[0.25822173, 0.41712395, 0.27892432],
               [0.88275133, 0.97811616, 0.46301445],
               [0.3846734 , 0.21568889, 0.71276888],
               [0.16342299, 0.03041244, 0.40224624],
               [0.71060873, 0.62350799, 0.97150042],
               [0.57999438, 0.78144529, 0.21321557],
               [0.10439042, 0.71635743, 0.78194125],
               [0.89714231, 0.26123842, 0.01970874],
               [0.52510616, 0.46613858, 0.65895473]])
        >>> Faure(3,randomize="False",seed=7,alpha=2)(9,warn=False)
        array([[0.        , 0.        , 0.        ],
               [0.44444444, 0.44444444, 0.44444444],
               [0.88888889, 0.88888889, 0.88888889],
               [0.16049383, 0.71604938, 0.60493827],
               [0.60493827, 0.16049383, 0.71604938],
               [0.71604938, 0.60493827, 0.16049383],
               [0.32098765, 0.43209877, 0.87654321],
               [0.43209877, 0.87654321, 0.32098765],
               [0.87654321, 0.32098765, 0.43209877]])
        
        Replications of higher order Faure
        
        >>> Faure(3,randomize="LMS DP",seed=7,alpha=2,replications=2)(9)
        array([[[0.65006542, 0.84004771, 0.39377772],
                [0.73541117, 0.25289783, 0.11639162],
                [0.11843564, 0.44363425, 0.98988211],
                [0.37561943, 0.50110654, 0.26965135],
                [0.79429224, 0.90984833, 0.69823833],
                [0.32592209, 0.08813056, 0.53196334],
                [0.47565296, 0.15886247, 0.84891661],
                [0.96885711, 0.55947605, 0.57425894],
                [0.05559154, 0.74599626, 0.07691998]],
        <BLANKLINE>
               [[0.01647589, 0.79799093, 0.98866597],
                [0.79175933, 0.39051971, 0.1440758 ],
                [0.57923112, 0.31651741, 0.39977363],
                [0.19716729, 0.14023077, 0.0888261 ],
                [0.9681839 , 0.73296284, 0.5775844 ],
                [0.41014543, 0.6588137 , 0.83313225],
                [0.28590138, 0.45066659, 0.52218222],
                [0.74006249, 0.04320102, 0.67774517],
                [0.51107317, 0.96909703, 0.26664273]]])
        >>> Faure(3,randomize="LMS DS",seed=7,alpha=2,replications=2)(9)
        array([[[0.82257501, 0.14639929, 0.60116121],
                [0.24249012, 0.98867933, 0.77186064],
                [0.43925164, 0.40287298, 0.12683077],
                [0.91956054, 0.44754172, 0.85119388],
                [0.08067361, 0.30216242, 0.31317864],
                [0.49966237, 0.71234433, 0.33572993],
                [0.75789644, 0.7949646 , 0.05999059],
                [0.17827381, 0.65360268, 0.52607183],
                [0.55976324, 0.05143265, 0.91398251]],
        <BLANKLINE>
               [[0.90790039, 0.30655016, 0.02228959],
                [0.34969458, 0.71397805, 0.9779997 ],
                [0.13261487, 0.45477877, 0.50021876],
                [0.71256557, 0.66536938, 0.789166  ],
                [0.48786265, 0.07285372, 0.41137525],
                [0.26253474, 0.81344564, 0.2669434 ],
                [0.87953962, 0.98487119, 0.58886448],
                [0.6628982 , 0.39219753, 0.2112249 ],
                [0.10438938, 0.1329926 , 0.73328965]]])
        >>> Faure(3,randomize="LMS",seed=7,alpha=2,replications=2)(9,warn=False)
        array([[[0.        , 0.        , 0.        ],
                [0.53148918, 0.85880934, 0.51685452],
                [0.95184459, 0.60232457, 0.98293576],
                [0.21282738, 0.35205188, 0.58389855],
                [0.59616274, 0.20653524, 0.72441959],
                [0.68272695, 0.94187019, 0.19189138],
                [0.2733855 , 0.7034865 , 0.79264466],
                [0.35996672, 0.5457835 , 0.27107157],
                [0.85440183, 0.28913878, 0.43628397]],
        <BLANKLINE>
               [[0.        , 0.        , 0.        ],
                [0.78765092, 0.85192948, 0.96805852],
                [0.56277838, 0.59274149, 0.49028114],
                [0.18069211, 0.36070495, 0.80396678],
                [0.95171191, 0.21257791, 0.43852003],
                [0.40600476, 0.9532375 , 0.29409298],
                [0.31884304, 0.68248734, 0.57074159],
                [0.76064476, 0.53425869, 0.20544726],
                [0.53167411, 0.27502561, 0.72751996]]])
        >>> Faure(3,randomize="NUS",seed=7,alpha=2,replications=2)(9)
        array([[[0.25822173, 0.41712395, 0.27892432],
                [0.88275133, 0.97811616, 0.46301445],
                [0.3846734 , 0.21568889, 0.71276888],
                [0.16342299, 0.03041244, 0.40224624],
                [0.71060873, 0.62350799, 0.97150042],
                [0.57999438, 0.78144529, 0.21321557],
                [0.10439042, 0.71635743, 0.78194125],
                [0.89714231, 0.26123842, 0.01970874],
                [0.52510616, 0.46613858, 0.65895473]],
        <BLANKLINE>
               [[0.1950677 , 0.52270739, 0.50736994],
                [0.95117968, 0.09639097, 0.23235875],
                [0.37944055, 0.98868015, 0.6693519 ],
                [0.27700817, 0.83696832, 0.072855  ],
                [0.6981059 , 0.3763676 , 0.8630192 ],
                [0.46377485, 0.28179682, 0.64253665],
                [0.01958311, 0.13843641, 0.9588172 ],
                [0.87752263, 0.7029967 , 0.35134227],
                [0.64185819, 0.55907117, 0.19929854]]])
    """
    
    DEFAULT_GENERATING_MATRICES = "FAURE"
