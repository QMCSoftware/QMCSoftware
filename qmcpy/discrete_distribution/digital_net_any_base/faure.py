from .digital_net_any_base import DigitalNetAnyBases


class Faure(DigitalNetAnyBases):
    r"""
    Low discrepancy Faure points.

    Note:
        - The first point of an unrandomized Faure sequence is the origin.
    
    Examples:
        >>> discrete_distrib = Faure(4,seed=7)
        >>> discrete_distrib(4)
        array([[0.93821576, 0.98657146, 0.32975962, 0.03942865],
               [0.58283196, 0.16959024, 0.53811273, 0.23004558],
               [0.01636438, 0.59543606, 0.95458401, 0.81716783],
               [0.69975534, 0.36527546, 0.74717761, 0.40420262]])
        >>> discrete_distrib
        Faure (AbstractLDDiscreteDistribution)
            d               2^(2)
            replications    1
            randomize       LMS DP
            t               14
            n_limit         2^(32)
            entropy         7
        
        Replications of independent randomizations 

        >>> x = Faure(3,seed=7,replications=2)(4)
        >>> x.shape
        (2, 4, 3)
        >>> x
        array([[[0.07060326, 0.73528722, 0.24685699],
                [0.83745824, 0.59870887, 0.82773772],
                [0.6043124 , 0.16585117, 0.42540718],
                [0.17372299, 0.45045811, 0.59981538]],
        <BLANKLINE>
               [[0.80940329, 0.4768136 , 0.79978683],
                [0.21034443, 0.93042812, 0.40497512],
                [0.51683229, 0.09321636, 0.3061612 ],
                [0.72632804, 0.80064811, 0.08157659]]])

        Unrandomized Faure 

        >>> Faure(4,randomize="FALSE",seed=7)(10,warn=False)
        array([[0.  , 0.  , 0.  , 0.  ],
               [0.2 , 0.2 , 0.2 , 0.2 ],
               [0.4 , 0.4 , 0.4 , 0.4 ],
               [0.6 , 0.6 , 0.6 , 0.6 ],
               [0.8 , 0.8 , 0.8 , 0.8 ],
               [0.04, 0.24, 0.44, 0.64],
               [0.24, 0.44, 0.64, 0.84],
               [0.44, 0.64, 0.84, 0.04],
               [0.64, 0.84, 0.04, 0.24],
               [0.84, 0.04, 0.24, 0.44]])
        
        All randomizations 

        >>> Faure(3,randomize="LMS DP",seed=7)(4)
        array([[0.09276526, 0.67280281, 0.05133827],
               [0.99257681, 0.47726151, 0.79454369],
               [0.52628644, 0.23872389, 0.65411616],
               [0.31075747, 0.66239464, 0.36868717]])
        >>> Faure(3,randomize="LMS DS",seed=7)(4)
        array([[0.27002269, 0.26003102, 0.63911171],
               [0.50326958, 0.38652922, 0.11399055],
               [0.74047972, 0.84089074, 0.70985883],
               [0.1504592 , 0.4608547 , 0.90612583]])
        >>> Faure(3,randomize="LMS",seed=7)(4,warn=False)
        array([[0.        , 0.        , 0.        ],
               [0.5706961 , 0.46031137, 0.93352076],
               [0.80394278, 0.91602768, 0.52944031],
               [0.22678173, 0.64529142, 0.3918998 ]])
        >>> Faure(3,randomize="DP",seed=7)(4)
        array([[0.62331102, 0.29902925, 0.90357572],
               [0.28997769, 0.63236259, 0.23690905],
               [0.95664436, 0.96569592, 0.57024238],
               [0.51219991, 0.52125147, 0.45913127]])
        >>> Faure(3,randomize="DS",seed=7)(4)
        array([[0.68058188, 0.23713299, 0.11174041],
               [0.01391521, 0.57046633, 0.44507375],
               [0.34724854, 0.90379966, 0.77840708],
               [0.79169299, 0.3482441 , 0.88951819]])
        >>> Faure(3,randomize="NUS",seed=7)(4)
        array([[0.077534  , 0.99285569, 0.64186774],
               [0.94791543, 0.60901162, 0.89583068],
               [0.46677419, 0.15577036, 0.26026352],
               [0.11491716, 0.53775495, 0.0447746 ]])
        
        Replications of randomizations 

        >>> Faure(3,randomize="LMS DP",seed=7,replications=2)(4)
        array([[[0.07060326, 0.73528722, 0.24685699],
                [0.83745824, 0.59870887, 0.82773772],
                [0.6043124 , 0.16585117, 0.42540718],
                [0.17372299, 0.45045811, 0.59981538]],
        <BLANKLINE>
               [[0.80940329, 0.4768136 , 0.79978683],
                [0.21034443, 0.93042812, 0.40497512],
                [0.51683229, 0.09321636, 0.3061612 ],
                [0.72632804, 0.80064811, 0.08157659]]])
        >>> Faure(3,randomize="LMS DS",seed=7,replications=2)(4)
        array([[[0.27004662, 0.992052  , 0.81876086],
                [0.50314089, 0.08151881, 0.41325789],
                [0.74050364, 0.53769238, 0.23094234],
                [0.15053374, 0.15569229, 0.20923783]],
        <BLANKLINE>
               [[0.36877002, 0.94741612, 0.98788497],
                [0.77245276, 0.01138116, 0.11154267],
                [0.06248099, 0.55415765, 0.38273953],
                [0.4938822 , 0.29044936, 0.50581969]]])
        >>> Faure(3,randomize="LMS",seed=7,replications=2)(4,warn=False)
        array([[[0.        , 0.        , 0.        ],
                [0.5706961 , 0.46031137, 0.93352076],
                [0.80394278, 0.91602768, 0.52944031],
                [0.22678173, 0.64529142, 0.3918998 ]],
        <BLANKLINE>
               [[0.        , 0.        , 0.        ],
                [0.41760589, 0.5468936 , 0.60514552],
                [0.71154927, 0.94015021, 0.87695198],
                [0.18050894, 0.35599445, 0.99994871]]])
        >>> Faure(3,randomize="DS",seed=7,replications=2)(4)
        array([[[0.68058188, 0.23713299, 0.11174041],
                [0.01391521, 0.57046633, 0.44507375],
                [0.34724854, 0.90379966, 0.77840708],
                [0.79169299, 0.3482441 , 0.88951819]],
        <BLANKLINE>
               [[0.04063513, 0.63145611, 0.22258204],
                [0.37396846, 0.96478945, 0.55591537],
                [0.7073018 , 0.29812278, 0.8892487 ],
                [0.15174624, 0.74256723, 0.66702648]]])
        >>> Faure(3,randomize="DP",seed=7,replications=2)(4)
        array([[[0.62331102, 0.29902925, 0.90357572],
                [0.28997769, 0.63236259, 0.23690905],
                [0.95664436, 0.96569592, 0.57024238],
                [0.51219991, 0.52125147, 0.45913127]],
        <BLANKLINE>
               [[0.06843544, 0.19251935, 0.84276152],
                [0.7351021 , 0.85918602, 0.50942819],
                [0.40176877, 0.52585269, 0.17609485],
                [0.29065766, 0.97029713, 0.06498374]]])
        >>> Faure(3,randomize="NUS",seed=7,replications=2)(4)
        array([[[0.077534  , 0.99285569, 0.64186774],
                [0.94791543, 0.60901162, 0.89583068],
                [0.46677419, 0.15577036, 0.26026352],
                [0.11491716, 0.53775495, 0.0447746 ]],
        <BLANKLINE>
               [[0.03739061, 0.16158904, 0.85379075],
                [0.85356456, 0.39368084, 0.49984113],
                [0.62407364, 0.86894123, 0.0326579 ],
                [0.27721099, 0.48157228, 0.328758  ]]])

    """
    
    DEFAULT_GENERATING_MATRICES = "FAURE"
