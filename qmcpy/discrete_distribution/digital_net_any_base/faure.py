from .digital_net_any_base import DigitalNetAnyBases


class Faure(DigitalNetAnyBases):
    r"""
    Low discrepancy Faure points.

    Note:
        - The first point of an unrandomized Faure sequence is the origin.
    
    Examples:
        >>> discrete_distrib = Faure(4,seed=7)
        >>> discrete_distrib(4)
        array([[0.1450272 , 0.587522  , 0.53005481, 0.72297587],
               [0.91002739, 0.9486738 , 0.99520878, 0.26209473],
               [0.38835418, 0.62726593, 0.71130669, 0.09272597],
               [0.43149581, 0.06796957, 0.01715528, 0.9998576 ]])
        >>> discrete_distrib
        Faure (AbstractLDDiscreteDistribution)
            d               2^(2)
            replications    1
            randomize       LMS DP
            t               63
            n_limit         2^(32)
            entropy         7
        
        Replications of independent randomizations 

        >>> x = Faure(3,seed=7,replications=2)(4)
        >>> x.shape
        (2, 4, 3)
        >>> x
        array([[[0.68991158, 0.61000002, 0.67989243],
                [0.58982495, 0.7175662 , 0.50462275],
                [0.12333072, 0.17197967, 0.31563725],
                [0.90367942, 0.99885531, 0.02770573]],
        <BLANKLINE>
               [[0.81876583, 0.85609978, 0.76079113],
                [0.49583728, 0.29945951, 0.0986577 ],
                [0.1730512 , 0.41731239, 0.422907  ],
                [0.97827231, 0.04710566, 0.54335177]]])

        Unrandomized Faure 

        >>> Faure(6,randomize="FALSE",seed=7)(4,warn=False)
        array([[0.        , 0.        , 0.        , 0.        , 0.        ,
                0.        ],
               [0.14285714, 0.14285714, 0.14285714, 0.14285714, 0.14285714,
                0.14285714],
               [0.28571429, 0.28571429, 0.28571429, 0.28571429, 0.28571429,
                0.28571429],
               [0.42857143, 0.42857143, 0.42857143, 0.42857143, 0.42857143,
                0.42857143]])
        
        All randomizations 

        >>> Faure(3,randomize="LMS DP",seed=7)(4)
        array([[0.6894943 , 0.31139262, 0.78744381],
               [0.45345276, 0.87022239, 0.04198496],
               [0.25871653, 0.42903509, 0.63353422],
               [0.79204932, 0.95957485, 0.46904675]])
        >>> Faure(3,randomize="LMS DS",seed=7)(4)
        array([[0.05631564, 0.3701308 , 0.27474945],
               [0.62289628, 0.13782096, 0.76230462],
               [0.81895352, 0.91797542, 0.4629459 ],
               [0.28289384, 0.05405794, 0.59451755]])
        >>> Faure(3,randomize="LMS",seed=7)(4,warn=False)
        array([[0.        , 0.        , 0.        ],
               [0.5706961 , 0.78569224, 0.82552878],
               [0.80394278, 0.56569421, 0.63728174],
               [0.22678173, 0.73927861, 0.36137831]])
        >>> Faure(3,randomize="DP",seed=7)(4)
        array([[0.62331102, 0.06843544, 0.08388064],
               [0.28997769, 0.7351021 , 0.7505473 ],
               [0.95664436, 0.40176877, 0.41721397],
               [0.51219991, 0.95732433, 0.63943619]])
        >>> Faure(3,randomize="DS",seed=7)(4)
        array([[0.68058188, 0.04063513, 0.95118644],
               [0.01391521, 0.37396846, 0.28451977],
               [0.34724854, 0.7073018 , 0.61785311],
               [0.79169299, 0.48507957, 0.39563088]])
        >>> Faure(3,randomize="NUS",seed=7)(4)
        array([[0.077534  , 0.99285569, 0.64186774],
               [0.76942988, 0.51938353, 0.87558099],
               [0.53911327, 0.11342811, 0.21919286],
               [0.17977799, 0.64810123, 0.23941264]])
        
        Replications of randomizations 

        >>> Faure(3,randomize="LMS DP",seed=7,replications=2)(4)
        array([[[0.68991158, 0.61000002, 0.67989243],
                [0.58982495, 0.7175662 , 0.50462275],
                [0.12333072, 0.17197967, 0.31563725],
                [0.90367942, 0.99885531, 0.02770573]],
        <BLANKLINE>
               [[0.81876583, 0.85609978, 0.76079113],
                [0.49583728, 0.29945951, 0.0986577 ],
                [0.1730512 , 0.41731239, 0.422907  ],
                [0.97827231, 0.04710566, 0.54335177]]])
        >>> Faure(3,randomize="LMS DS",seed=7,replications=2)(4)
        array([[[0.6538159 , 0.16092731, 0.93868703],
                [0.88691037, 0.94641633, 0.43041743],
                [0.08312003, 0.39311863, 0.13104798],
                [0.53430321, 0.86255169, 0.26257099]],
        <BLANKLINE>
               [[0.44108788, 0.99956178, 0.98990086],
                [0.08383611, 0.2123527 , 0.66018507],
                [0.76519947, 0.43743607, 0.33185838],
                [0.56491664, 0.02895038, 0.19450265]]])
        >>> Faure(3,randomize="LMS",seed=7,replications=2)(4,warn=False)
        array([[[0.        , 0.        , 0.        ],
                [0.5706961 , 0.78569224, 0.82552878],
                [0.80394278, 0.56569421, 0.63728174],
                [0.22678173, 0.73927861, 0.36137831]],
        <BLANKLINE>
               [[0.        , 0.        , 0.        ],
                [0.68138291, 0.56258547, 0.67182785],
                [0.36136951, 0.78771964, 0.34211248],
                [0.27218584, 0.4916658 , 0.57972029]]])
        >>> Faure(3,randomize="DS",seed=7,replications=2)(4)
        array([[[0.68058188, 0.04063513, 0.95118644],
                [0.01391521, 0.37396846, 0.28451977],
                [0.34724854, 0.7073018 , 0.61785311],
                [0.79169299, 0.48507957, 0.39563088]],
        <BLANKLINE>
               [[0.84906488, 0.80260469, 0.23741973],
                [0.18239822, 0.13593802, 0.57075307],
                [0.51573155, 0.46927136, 0.9040864 ],
                [0.96017599, 0.24704914, 0.68186418]]])
        >>> Faure(3,randomize="DP",seed=7,replications=2)(4)
        array([[[0.62331102, 0.06843544, 0.08388064],
                [0.28997769, 0.7351021 , 0.7505473 ],
                [0.95664436, 0.40176877, 0.41721397],
                [0.51219991, 0.95732433, 0.63943619]],
        <BLANKLINE>
               [[0.46181744, 0.97659973, 0.16880003],
                [0.1284841 , 0.30993307, 0.50213337],
                [0.79515077, 0.6432664 , 0.8354667 ],
                [0.57292855, 0.19882195, 0.72435559]]])
        >>> Faure(3,randomize="NUS",seed=7,replications=2)(4)
        array([[[0.077534  , 0.99285569, 0.64186774],
                [0.76942988, 0.51938353, 0.87558099],
                [0.53911327, 0.11342811, 0.21919286],
                [0.17977799, 0.64810123, 0.23941264]],
        <BLANKLINE>
               [[0.03739061, 0.16158904, 0.85379075],
                [0.81803013, 0.33578478, 0.54313257],
                [0.61650583, 0.84596814, 0.14149313],
                [0.3148744 , 0.57185614, 0.06912783]]])

    """
    
    DEFAULT_GENERATING_MATRICES = "FAURE"
